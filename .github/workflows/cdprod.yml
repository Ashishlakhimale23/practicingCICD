name : practicing github actions for staging branch
on : 
    push:
        branches:
            - main
jobs : 
    build : 
        name : Build 
        runs-on : ubuntu-latest
        steps: 
            - name : executing the code on the vm
              uses : appleboy/ssh-action@master
              with : 
                host : 65.0.125.209 
                username : ubuntu
                key : ${{secrets.PRIVATE_SECRET_KEY}}
                port : 22
                script : | 
                    if [ -d "/home/ubuntu/practicingCICD" ]; then
                        cd practicingCICD
                    else
                        gitclone https://github.com/Ashishlakhimale23/practicingCICD.git 
                        cd practicingCICD
                    fi
                    git fetch origin main 
                    git checkout main 
                    git pull origin main
                    npm install 
                    npm run build 
                    npm run dev
